<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <style>
    body{position: relative;}
    #sidebar{
      position: absolute;
      top: 0;
      right: 0;
    }
    #sidebar a{
      display: block;
      padding: 4px 8px;
      text-decoration: none;
      color: #b7b7b7;
    }
    #sidebar a:hover{
      color: #369;
      text-decoration: underline;
    }
  </style>
</head>
<body>
<div id="view"></div>
<div id="sidebar"></div>
<script src="lib/graphviz.min.js"></script>
<script src="lib/view2dot.js"></script>
<script src="vega.js"></script>
<script>

  const dot = O;

  fetch(`json/${location.search.substr(1)}.json`)
    .then(res => res.json())
    .then(option => {

      const view = new vega.View(vega.parse(option), {
        renderer:  'canvas',  // renderer (canvas or svg)
        container: '#view',   // parent DOM container
        hover:     true       // enable hover processing
      });

      console.log(view);

      view.runAsync();

      // var s = [`${view2dot(view)}`];

      // document.body.appendChild(dot(s));

    });

  fetch('http://localhost/Visualization/vega/examples/server.php', {method: 'get'})
    .then(res => res.json())
    .then(data => {

      document.getElementById('sidebar').innerHTML = data.reduce((str, datum) => {
        datum = datum.replace('.json', '');
        return str += `<a href="?${datum}" target="_self">${datum}</a>`;
      }, '');

    });

</script>
</body>
</html>
